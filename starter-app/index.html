<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://miro.com/app/static/sdk.1.1.js"></script>
    <script>

        function postData(endpoint, data) {
            fetch("https://hittatilltf.com/" + endpoint, {
                method: "POST",
                headers: {},
                body: JSON.stringify(data)
            }).then(res => {
                console.log(res.status)
            });
        };

        async function handleClickEvent(event) {
            console.log("click!!")
            let board = await miro.board.info.get();
            let user = await miro.account.get();
            let data = {
                type: "CLICK",
                board: board.id,
                user: user.id
            };
            postData("add_event", data);
        };

        miro.onReady(() => {
            miro.addListener("CANVAS_CLICKED", handleClickEvent);
            console.log("kappa");
        });
        
        miro.initialize({
            extensionPoints: {
                bottomBar: {
                    title: "Analytics Toolkit",
                    svgIcon: "https://upload.wikimedia.org/wikipedia/commons/7/73/Flat_tick_icon.svg",
                    onClick: () => {
                        console.log("lol");
                    }
                }
            }
        });
    </script>
</head>
</html>
